{"version":3,"file":"Leaflet.SwoopyArrow.js","sources":["../node_modules/leaflet-curve/leaflet.curve.js","../node_modules/shortid/index.js","../src/index.js"],"sourcesContent":["/*\r\n * Leaflet.curve v0.1.0 - a plugin for Leaflet mapping library. https://github.com/elfalem/Leaflet.curve\r\n * (c) elfalem 2015\r\n */\r\n/*\r\n * note that SVG (x, y) corresponds to (long, lat)\r\n */\r\n\r\nL.Curve = L.Path.extend({\r\n\toptions: {\r\n\t},\r\n\t\r\n\tinitialize: function(path, options){\r\n\t\tL.setOptions(this, options);\r\n\t\tthis._setPath(path);\r\n\t},\r\n\t\r\n\tgetPath: function(){\r\n\t\treturn this._coords;\r\n\t},\r\n\t\r\n\tsetPath: function(path){\r\n\t\tthis._setPath(path);\r\n\t\treturn this.redraw();\r\n\t},\r\n\t\r\n\tgetBounds: function() {\r\n\t\treturn this._bounds;\r\n\t},\r\n\r\n\t_setPath: function(path){\r\n\t\tthis._coords = path;\r\n\t\tthis._bounds = this._computeBounds();\r\n\t},\r\n\t\r\n\t_computeBounds: function(){\r\n\t\tvar bound = new L.LatLngBounds();\r\n\t\tvar lastPoint;\r\n\t\tvar lastCommand;\r\n\t\tfor(var i = 0; i < this._coords.length; i++){\r\n\t\t\tcoord = this._coords[i];\r\n\t\t\tif(typeof coord == 'string' || coord instanceof String){\r\n\t\t\t\tlastCommand = coord;\r\n\t\t\t}else if(lastCommand == 'H'){\r\n\t\t\t\tbound.extend([lastPoint.lat,coord[0]]);\r\n\t\t\t\tlastPoint = new L.latLng(lastPoint.lat,coord[0]);\r\n\t\t\t}else if(lastCommand == 'V'){\r\n\t\t\t\tbound.extend([coord[0], lastPoint.lng]);\r\n\t\t\t\tlastPoint = new L.latLng(coord[0], lastPoint.lng);\r\n\t\t\t}else if(lastCommand == 'C'){\r\n\t\t\t\tvar controlPoint1 = new L.latLng(coord[0], coord[1]);\r\n\t\t\t\tcoord = this._coords[++i];\r\n\t\t\t\tvar controlPoint2 = new L.latLng(coord[0], coord[1]);\r\n\t\t\t\tcoord = this._coords[++i];\r\n\t\t\t\tvar endPoint = new L.latLng(coord[0], coord[1]);\r\n\r\n\t\t\t\tbound.extend(controlPoint1);\r\n\t\t\t\tbound.extend(controlPoint2);\r\n\t\t\t\tbound.extend(endPoint);\r\n\r\n\t\t\t\tendPoint.controlPoint1 = controlPoint1;\r\n\t\t\t\tendPoint.controlPoint2 = controlPoint2;\r\n\t\t\t\tlastPoint = endPoint;\r\n\t\t\t}else if(lastCommand == 'S'){\r\n\t\t\t\tvar controlPoint2 = new L.latLng(coord[0], coord[1]);\r\n\t\t\t\tcoord = this._coords[++i];\r\n\t\t\t\tvar endPoint = new L.latLng(coord[0], coord[1]);\r\n\r\n\t\t\t\tvar controlPoint1 = lastPoint;\r\n\t\t\t\tif(lastPoint.controlPoint2){\r\n\t\t\t\t\tvar diffLat = lastPoint.lat - lastPoint.controlPoint2.lat;\r\n\t\t\t\t\tvar diffLng = lastPoint.lng - lastPoint.controlPoint2.lng;\r\n\t\t\t\t\tcontrolPoint1 = new L.latLng(lastPoint.lat + diffLat, lastPoint.lng + diffLng);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbound.extend(controlPoint1);\r\n\t\t\t\tbound.extend(controlPoint2);\r\n\t\t\t\tbound.extend(endPoint);\r\n\r\n\t\t\t\tendPoint.controlPoint1 = controlPoint1;\r\n\t\t\t\tendPoint.controlPoint2 = controlPoint2;\r\n\t\t\t\tlastPoint = endPoint;\r\n\t\t\t}else if(lastCommand == 'Q'){\r\n\t\t\t\tvar controlPoint = new L.latLng(coord[0], coord[1]);\r\n\t\t\t\tcoord = this._coords[++i];\r\n\t\t\t\tvar endPoint = new L.latLng(coord[0], coord[1]);\r\n\r\n\t\t\t\tbound.extend(controlPoint);\r\n\t\t\t\tbound.extend(endPoint);\r\n\r\n\t\t\t\tendPoint.controlPoint = controlPoint;\r\n\t\t\t\tlastPoint = endPoint;\r\n\t\t\t}else if(lastCommand == 'T'){\r\n\t\t\t\tvar endPoint = new L.latLng(coord[0], coord[1]);\r\n\r\n\t\t\t\tvar controlPoint = lastPoint;\r\n\t\t\t\tif(lastPoint.controlPoint){\r\n\t\t\t\t\tvar diffLat = lastPoint.lat - lastPoint.controlPoint.lat;\r\n\t\t\t\t\tvar diffLng = lastPoint.lng - lastPoint.controlPoint.lng;\r\n\t\t\t\t\tcontrolPoint = new L.latLng(lastPoint.lat + diffLat, lastPoint.lng + diffLng);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbound.extend(controlPoint);\r\n\t\t\t\tbound.extend(endPoint);\r\n\r\n\t\t\t\tendPoint.controlPoint = controlPoint;\r\n\t\t\t\tlastPoint = endPoint;\r\n\t\t\t}else{\r\n\t\t\t\tbound.extend(coord);\r\n\t\t\t\tlastPoint = new L.latLng(coord[0], coord[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn bound;\r\n\t},\r\n\t\r\n\t//TODO: use a centroid algorithm instead\r\n\tgetCenter: function () {\r\n\t\treturn this._bounds.getCenter();\r\n\t},\r\n\t\r\n\t_update: function(){\r\n\t\tif (!this._map) { return; }\r\n\t\t\r\n\t\tthis._updatePath();\r\n\t},\r\n\t\r\n\t_updatePath: function() {\r\n\t\tthis._renderer._updatecurve(this);\r\n\t},\r\n\r\n\t_project: function() {\r\n\t\tvar coord, lastCoord, curCommand, curPoint;\r\n\r\n\t\tthis._points = [];\r\n\t\t\r\n\t\tfor(var i = 0; i < this._coords.length; i++){\r\n\t\t\tcoord = this._coords[i];\r\n\t\t\tif(typeof coord == 'string' || coord instanceof String){\r\n\t\t\t\tthis._points.push(coord);\r\n\t\t\t\tcurCommand = coord;\r\n\t\t\t}else {\r\n\t\t\t\tswitch(coord.length){\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tcurPoint = this._map.latLngToLayerPoint(coord);\r\n\t\t\t\t\t\tlastCoord = coord;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tif(curCommand == 'H'){\r\n\t\t\t\t\t\t\tcurPoint = this._map.latLngToLayerPoint([lastCoord[0], coord[0]]);\r\n\t\t\t\t\t\t\tlastCoord = [lastCoord[0], coord[0]];\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tcurPoint = this._map.latLngToLayerPoint([coord[0], lastCoord[1]]);\r\n\t\t\t\t\t\t\tlastCoord = [coord[0], lastCoord[1]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tthis._points.push(curPoint);\r\n\t\t\t}\r\n\t\t}\r\n\t}\t\r\n});\r\n\r\nL.curve = function (path, options){\r\n\treturn new L.Curve(path, options);\r\n};\r\n\r\nL.SVG.include({\r\n\t_updatecurve: function(layer){\r\n\t\tthis._setPath(layer, this._curvePointsToPath(layer._points));\r\n    \t},\r\n \t_curvePointsToPath: function(points){\r\n\t\tvar point, curCommand, str = '';\r\n\t\tfor(var i = 0; i < points.length; i++){\r\n\t\t\tpoint = points[i];\r\n\t\t\tif(typeof point == 'string' || point instanceof String){\r\n\t\t\t\tcurCommand = point;\r\n\t\t\t\tstr += curCommand;\r\n\t\t\t}else{\r\n\t\t\t\tswitch(curCommand){\r\n\t\t\t\t\tcase 'H':\r\n\t\t\t\t\t\tstr += point.x + ' ';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'V':\r\n\t\t\t\t\t\tstr += point.y + ' ';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tstr += point.x + ',' + point.y + ' ';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn str || 'M0 0';\r\n\t}\r\n});\r\n","'use strict';\nmodule.exports = require('./lib/index');\n","import L from 'leaflet';\nimport 'leaflet-curve';\nimport 'shortid';\nimport '@turf/helpers';\nimport '@turf/center';\n\nL.SwoopyArrow = L.Layer.extend({\n  options: {\n    fromLatlng: [],\n    toLatlng: [],\n    htmlLabel: '',\n    color: 'black',\n    labelClass: '',\n    opacity: 1,\n    minZoom: 0,\n    maxZoom: 22,\n    factor: 0\n  },\n\n  initialize: function (options) {\n    L.Util.setOptions(this, options);\n\n    this._currentPathVisible = true;\n    this._fromLatlng = L.latLng(this.options.fromLatlng);\n    this._toLatlng = L.latLng(this.options.toLatlng);\n    this._factor = this.options.factor;\n    this._controlLatlng = L.latLng(this._getControlPoint(L.latLng(this.options.fromLatlng), L.latLng(this.options.toLatlng), this.options.factor));\n    this._htmlLabel = this.options.htmlLabel;\n    this._labelSize = this.options.labelSize;\n    this._color = this.options.color;\n    this._labelClass = this.options.labelClass;\n    this._opacity = this.options.opacity;\n    this._minZoom = this.options.minZoom;\n    this._maxZoom = this.options.maxZoom;\n\n    this._initSVG();\n  },\n\n  _initSVG: function () {\n    this._svg = L.SVG.create('svg');\n    this._currentId = shortid.generate();\n\n    this._arrow = this._createArrow();\n    this._svg.appendChild(this._arrow);\n  },\n\n  onAdd: function (map) {\n    this._map = map;\n    this.getPane().appendChild(this._svg);\n\n    this._drawSwoopyArrows();\n\n    this.update(this._map);\n  },\n\n  getEvents: function () {\n    return {\n      zoom: this.update,\n      viewreset: this.update\n    };\n  },\n\n  _drawSwoopyArrows: function() {\n    const swoopyPath = this._createPath();\n    this._currentPath = swoopyPath._path;\n\n    const swoopyLabel = this._createLabel();\n    this._currentMarker = L.marker([this._fromLatlng.lat, this._fromLatlng.lng], { icon: swoopyLabel }).addTo( this._map);\n  },\n\n  _createArrow: function () {\n    this._container = this._container || L.SVG.create('defs');\n    const marker = L.SVG.create('marker');\n    const path = L.SVG.create('polyline');\n\n    marker.setAttribute('id', `swoopyarrow__arrowhead${this._currentId}`);\n    L.DomUtil.addClass(marker, 'swoopyArrow__marker');\n    marker.setAttribute('markerWidth', '20');\n    marker.setAttribute('markerHeight', '20');\n    marker.setAttribute('viewBox', '-10 -10 20 20');\n    marker.setAttribute('orient', 'auto');\n    marker.setAttribute('refX', '0');\n    marker.setAttribute('refY', '0');\n    marker.setAttribute('fill', 'none');\n    marker.setAttribute('stroke', this._color);\n    marker.setAttribute('stroke-width', 1);\n    marker.setAttribute('opacity', this._opacity);\n\n    path.setAttribute('stroke-linejoin', 'bevel');\n    path.setAttribute('fill', 'none');\n    path.setAttribute('stroke', this._color);\n    path.setAttribute('points', '-6.75,-6.75 0,0 -6.75,6.75');\n\n    marker.appendChild(path);\n    this._container.appendChild(marker);\n\n    return this._container;\n  },\n\n  _createPath: function () {\n    const pathOne = L.curve(\n      [\n        'M', [this._fromLatlng.lat, this._fromLatlng.lng],\n        'Q', [this._controlLatlng.lat, this._controlLatlng.lng], [this._toLatlng.lat, this._toLatlng.lng]\n\n      ], {\n        animate: false,\n        color: this._color,\n        fill: false,\n        opacity: this._opacity,\n        weight: 1,\n        className: 'swoopyarrow__path'\n      }\n    ).addTo(map);\n\n    pathOne._path.setAttribute('id', `swoopyarrow__path${this._currentId}`);\n    pathOne._path.setAttribute('marker-end', `url(#swoopyarrow__arrowhead${this._currentId})`);\n\n    return pathOne;\n  },\n\n\n  _rotatePoint: function (origin, point, angle) {\n    const radians = angle * Math.PI / 180.0;\n\n    return {\n      x: Math.cos(radians) * (point.x - origin.x) - Math.sin(radians) * (point.y - origin.y) + origin.x,\n      y: Math.sin(radians) * (point.x - origin.x) + Math.cos(radians) * (point.y - origin.y) + origin.y\n    };\n  },\n\n  _getControlPoint: function (start, end, factor) {\n    const features = turf.featureCollection([\n      turf.point( [start.lat, start.lng]),\n      turf.point( [end.lat, end.lng])\n    ]);\n\n    const center = turf.center(features);\n\n    // get pixel coordinates for start, end and center\n    const startPx = map.latLngToContainerPoint(start);\n    const centerPx = map.latLngToContainerPoint(L.latLng(center.geometry.coordinates[0], center.geometry.coordinates[1]));\n    const rotatedPx = this._rotatePoint(centerPx, startPx, 90);\n\n\n    const distance = Math.sqrt(Math.pow(startPx.x - centerPx.x, 2) + Math.pow(startPx.y - centerPx.y, 2));\n    const angle = Math.atan2(rotatedPx.y - centerPx.y, rotatedPx.x - centerPx.x);\n\n\n    const offset = (factor * distance) - distance;\n\n    const sin = Math.sin(angle) * offset;\n    const cos = Math.cos(angle) * offset;\n\n    const controlPoint = L.point(rotatedPx.x + cos, rotatedPx.y + sin);\n\n    return map.containerPointToLatLng(controlPoint);\n  },\n\n  _createLabel: function() {\n    return L.divIcon({\n      className: this._labelClass,\n      html: `<span id=\"marker-label${this._currentId}\" style=\"font-size: ${this._map.getZoom() * this._labelSize}px\">${this._htmlLabel}</span>`,\n      iconAnchor: [this._fromLatlng.lat, this._fromLatlng.lng],\n      iconSize: 'auto'\n    });\n  },\n\n  update: function (map) {\n    this._checkZoomLevel();\n\n    const arrowHead = this._svg.getElementById(`swoopyarrow__arrowhead${this._currentId}`);\n    arrowHead.setAttribute('markerWidth', `${2.5 * this._map.getZoom()}`);\n    arrowHead.setAttribute('markerHeight', `${2.5 * this._map.getZoom()}`);\n\n    const label = document.getElementById(`marker-label${this._currentId}`);\n    label.setAttribute('style', `font-size: ${this._map.getZoom() * 0.2 * this._labelSize}px;`);\n\n    return this;\n  },\n\n  _checkZoomLevel: function() {\n    const currentZoomLevel = this._map.getZoom();\n\n    if(!this._currentPathVisible) {\n      this._currentPath.setAttribute('opacity', this._opacity);\n      this._currentMarker.setOpacity(this._opacity);\n    }\n\n    if(currentZoomLevel < this._minZoom || currentZoomLevel > this._maxZoom) {\n      this._currentPath.setAttribute('opacity', 0);\n      this._currentMarker.setOpacity(0);\n\n      this._currentPathVisible = false;\n    }\n  }\n})\n"],"names":["L","SwoopyArrow","Layer","extend","options","Util","setOptions","_currentPathVisible","_fromLatlng","latLng","fromLatlng","_toLatlng","toLatlng","_factor","factor","_controlLatlng","_getControlPoint","_htmlLabel","htmlLabel","_labelSize","labelSize","_color","color","_labelClass","labelClass","_opacity","opacity","_minZoom","minZoom","_maxZoom","maxZoom","_initSVG","_svg","SVG","create","_currentId","shortid","generate","_arrow","_createArrow","appendChild","map","_map","getPane","_drawSwoopyArrows","update","swoopyPath","_createPath","_currentPath","_path","swoopyLabel","_createLabel","_currentMarker","marker","lat","lng","icon","addTo","_container","path","setAttribute","DomUtil","addClass","pathOne","curve","origin","point","angle","radians","Math","PI","cos","x","sin","y","start","end","features","turf","featureCollection","center","startPx","latLngToContainerPoint","centerPx","geometry","coordinates","rotatedPx","_rotatePoint","distance","sqrt","pow","atan2","offset","controlPoint","containerPointToLatLng","divIcon","getZoom","_checkZoomLevel","arrowHead","getElementById","label","document","currentZoomLevel","setOpacity"],"mappings":";;;;;;;;AAAA;;;;;;;;AAQA,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;CACvB,OAAO,EAAE;EACR;;CAED,UAAU,EAAE,SAAS,IAAI,EAAE,OAAO,CAAC;EAClC,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;EAC5B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;EACpB;;CAED,OAAO,EAAE,UAAU;EAClB,OAAO,IAAI,CAAC,OAAO,CAAC;EACpB;;CAED,OAAO,EAAE,SAAS,IAAI,CAAC;EACtB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;EACpB,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC;EACrB;;CAED,SAAS,EAAE,WAAW;EACrB,OAAO,IAAI,CAAC,OAAO,CAAC;EACpB;;CAED,QAAQ,EAAE,SAAS,IAAI,CAAC;EACvB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;EACpB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;EACrC;;CAED,cAAc,EAAE,UAAU;EACzB,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,YAAY,EAAE,CAAC;EACjC,IAAI,SAAS,CAAC;EACd,IAAI,WAAW,CAAC;EAChB,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC;GAC3C,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;GACxB,GAAG,OAAO,KAAK,IAAI,QAAQ,IAAI,KAAK,YAAY,MAAM,CAAC;IACtD,WAAW,GAAG,KAAK,CAAC;IACpB,KAAK,GAAG,WAAW,IAAI,GAAG,CAAC;IAC3B,KAAK,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACvC,SAAS,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACjD,KAAK,GAAG,WAAW,IAAI,GAAG,CAAC;IAC3B,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;IACxC,SAAS,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;IAClD,KAAK,GAAG,WAAW,IAAI,GAAG,CAAC;IAC3B,IAAI,aAAa,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1B,IAAI,aAAa,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1B,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;IAEhD,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC5B,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC5B,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;IAEvB,QAAQ,CAAC,aAAa,GAAG,aAAa,CAAC;IACvC,QAAQ,CAAC,aAAa,GAAG,aAAa,CAAC;IACvC,SAAS,GAAG,QAAQ,CAAC;IACrB,KAAK,GAAG,WAAW,IAAI,GAAG,CAAC;IAC3B,IAAI,aAAa,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1B,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;IAEhD,IAAI,aAAa,GAAG,SAAS,CAAC;IAC9B,GAAG,SAAS,CAAC,aAAa,CAAC;KAC1B,IAAI,OAAO,GAAG,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,aAAa,CAAC,GAAG,CAAC;KAC1D,IAAI,OAAO,GAAG,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,aAAa,CAAC,GAAG,CAAC;KAC1D,aAAa,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,GAAG,OAAO,EAAE,SAAS,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC;KAC/E;;IAED,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC5B,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC5B,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;IAEvB,QAAQ,CAAC,aAAa,GAAG,aAAa,CAAC;IACvC,QAAQ,CAAC,aAAa,GAAG,aAAa,CAAC;IACvC,SAAS,GAAG,QAAQ,CAAC;IACrB,KAAK,GAAG,WAAW,IAAI,GAAG,CAAC;IAC3B,IAAI,YAAY,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACpD,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1B,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;IAEhD,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;IAC3B,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;IAEvB,QAAQ,CAAC,YAAY,GAAG,YAAY,CAAC;IACrC,SAAS,GAAG,QAAQ,CAAC;IACrB,KAAK,GAAG,WAAW,IAAI,GAAG,CAAC;IAC3B,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;IAEhD,IAAI,YAAY,GAAG,SAAS,CAAC;IAC7B,GAAG,SAAS,CAAC,YAAY,CAAC;KACzB,IAAI,OAAO,GAAG,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,YAAY,CAAC,GAAG,CAAC;KACzD,IAAI,OAAO,GAAG,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,YAAY,CAAC,GAAG,CAAC;KACzD,YAAY,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,GAAG,OAAO,EAAE,SAAS,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC;KAC9E;;IAED,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;IAC3B,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;IAEvB,QAAQ,CAAC,YAAY,GAAG,YAAY,CAAC;IACrC,SAAS,GAAG,QAAQ,CAAC;IACrB,IAAI;IACJ,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACpB,SAAS,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7C;GACD;EACD,OAAO,KAAK,CAAC;EACb;;;CAGD,SAAS,EAAE,YAAY;EACtB,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC;EAChC;;CAED,OAAO,EAAE,UAAU;EAClB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,EAAE;;EAE3B,IAAI,CAAC,WAAW,EAAE,CAAC;EACnB;;CAED,WAAW,EAAE,WAAW;EACvB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;EAClC;;CAED,QAAQ,EAAE,WAAW;EACpB,IAAI,KAAK,EAAE,SAAS,EAAE,UAAU,EAAE,QAAQ,CAAC;;EAE3C,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;;EAElB,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC;GAC3C,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;GACxB,GAAG,OAAO,KAAK,IAAI,QAAQ,IAAI,KAAK,YAAY,MAAM,CAAC;IACtD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACzB,UAAU,GAAG,KAAK,CAAC;IACnB,KAAK;IACL,OAAO,KAAK,CAAC,MAAM;KAClB,KAAK,CAAC;MACL,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;MAC/C,SAAS,GAAG,KAAK,CAAC;KACnB,MAAM;KACN,KAAK,CAAC;MACL,GAAG,UAAU,IAAI,GAAG,CAAC;OACpB,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;OAClE,SAAS,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;OACrC,IAAI;OACJ,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;OAClE,SAAS,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;OACrC;KACF,MAAM;KACN;IACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC5B;GACD;EACD;CACD,CAAC,CAAC;;AAEH,CAAC,CAAC,KAAK,GAAG,UAAU,IAAI,EAAE,OAAO,CAAC;CACjC,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;CAClC,CAAC;;AAEF,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC;CACb,YAAY,EAAE,SAAS,KAAK,CAAC;EAC5B,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;MACzD;EACJ,kBAAkB,EAAE,SAAS,MAAM,CAAC;EACpC,IAAI,KAAK,EAAE,UAAU,EAAE,GAAG,GAAG,EAAE,CAAC;EAChC,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC;GACrC,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;GAClB,GAAG,OAAO,KAAK,IAAI,QAAQ,IAAI,KAAK,YAAY,MAAM,CAAC;IACtD,UAAU,GAAG,KAAK,CAAC;IACnB,GAAG,IAAI,UAAU,CAAC;IAClB,IAAI;IACJ,OAAO,UAAU;KAChB,KAAK,GAAG;MACP,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC;MACrB,MAAM;KACP,KAAK,GAAG;MACP,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC;MACrB,MAAM;KACP;MACC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC;MACrC,MAAM;KACP;IACD;GACD;EACD,OAAO,GAAG,IAAI,MAAM,CAAC;EACrB;CACD,CAAC,CAAC;;ACjMH,YAAY,CAAC;AACb,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;;ACKxCA,IAAEC,WAAF,GAAgBD,IAAEE,KAAF,CAAQC,MAAR,CAAe;WACpB;gBACK,EADL;cAEG,EAFH;eAGI,EAHJ;WAIA,OAJA;gBAKK,EALL;aAME,CANF;aAOE,CAPF;aAQE,EARF;YASC;GAVmB;;cAajB,oBAAUC,OAAV,EAAmB;QAC3BC,IAAF,CAAOC,UAAP,CAAkB,IAAlB,EAAwBF,OAAxB;;SAEKG,mBAAL,GAA2B,IAA3B;SACKC,WAAL,GAAmBR,IAAES,MAAF,CAAS,KAAKL,OAAL,CAAaM,UAAtB,CAAnB;SACKC,SAAL,GAAiBX,IAAES,MAAF,CAAS,KAAKL,OAAL,CAAaQ,QAAtB,CAAjB;SACKC,OAAL,GAAe,KAAKT,OAAL,CAAaU,MAA5B;SACKC,cAAL,GAAsBf,IAAES,MAAF,CAAS,KAAKO,gBAAL,CAAsBhB,IAAES,MAAF,CAAS,KAAKL,OAAL,CAAaM,UAAtB,CAAtB,EAAyDV,IAAES,MAAF,CAAS,KAAKL,OAAL,CAAaQ,QAAtB,CAAzD,EAA0F,KAAKR,OAAL,CAAaU,MAAvG,CAAT,CAAtB;SACKG,UAAL,GAAkB,KAAKb,OAAL,CAAac,SAA/B;SACKC,UAAL,GAAkB,KAAKf,OAAL,CAAagB,SAA/B;SACKC,MAAL,GAAc,KAAKjB,OAAL,CAAakB,KAA3B;SACKC,WAAL,GAAmB,KAAKnB,OAAL,CAAaoB,UAAhC;SACKC,QAAL,GAAgB,KAAKrB,OAAL,CAAasB,OAA7B;SACKC,QAAL,GAAgB,KAAKvB,OAAL,CAAawB,OAA7B;SACKC,QAAL,GAAgB,KAAKzB,OAAL,CAAa0B,OAA7B;;SAEKC,QAAL;GA7B2B;;YAgCnB,oBAAY;SACfC,IAAL,GAAYhC,IAAEiC,GAAF,CAAMC,MAAN,CAAa,KAAb,CAAZ;SACKC,UAAL,GAAkBC,QAAQC,QAAR,EAAlB;;SAEKC,MAAL,GAAc,KAAKC,YAAL,EAAd;SACKP,IAAL,CAAUQ,WAAV,CAAsB,KAAKF,MAA3B;GArC2B;;SAwCtB,eAAUG,GAAV,EAAe;SACfC,IAAL,GAAYD,GAAZ;SACKE,OAAL,GAAeH,WAAf,CAA2B,KAAKR,IAAhC;;SAEKY,iBAAL;;SAEKC,MAAL,CAAY,KAAKH,IAAjB;GA9C2B;;aAiDlB,qBAAY;WACd;YACC,KAAKG,MADN;iBAEM,KAAKA;KAFlB;GAlD2B;;qBAwDV,6BAAW;QACtBC,aAAa,KAAKC,WAAL,EAAnB;SACKC,YAAL,GAAoBF,WAAWG,KAA/B;;QAEMC,cAAc,KAAKC,YAAL,EAApB;SACKC,cAAL,GAAsBpD,IAAEqD,MAAF,CAAS,CAAC,KAAK7C,WAAL,CAAiB8C,GAAlB,EAAuB,KAAK9C,WAAL,CAAiB+C,GAAxC,CAAT,EAAuD,EAAEC,MAAMN,WAAR,EAAvD,EAA8EO,KAA9E,CAAqF,KAAKf,IAA1F,CAAtB;GA7D2B;;gBAgEf,wBAAY;SACnBgB,UAAL,GAAkB,KAAKA,UAAL,IAAmB1D,IAAEiC,GAAF,CAAMC,MAAN,CAAa,MAAb,CAArC;QACMmB,SAASrD,IAAEiC,GAAF,CAAMC,MAAN,CAAa,QAAb,CAAf;QACMyB,OAAO3D,IAAEiC,GAAF,CAAMC,MAAN,CAAa,UAAb,CAAb;;WAEO0B,YAAP,CAAoB,IAApB,6BAAmD,KAAKzB,UAAxD;QACE0B,OAAF,CAAUC,QAAV,CAAmBT,MAAnB,EAA2B,qBAA3B;WACOO,YAAP,CAAoB,aAApB,EAAmC,IAAnC;WACOA,YAAP,CAAoB,cAApB,EAAoC,IAApC;WACOA,YAAP,CAAoB,SAApB,EAA+B,eAA/B;WACOA,YAAP,CAAoB,QAApB,EAA8B,MAA9B;WACOA,YAAP,CAAoB,MAApB,EAA4B,GAA5B;WACOA,YAAP,CAAoB,MAApB,EAA4B,GAA5B;WACOA,YAAP,CAAoB,MAApB,EAA4B,MAA5B;WACOA,YAAP,CAAoB,QAApB,EAA8B,KAAKvC,MAAnC;WACOuC,YAAP,CAAoB,cAApB,EAAoC,CAApC;WACOA,YAAP,CAAoB,SAApB,EAA+B,KAAKnC,QAApC;;SAEKmC,YAAL,CAAkB,iBAAlB,EAAqC,OAArC;SACKA,YAAL,CAAkB,MAAlB,EAA0B,MAA1B;SACKA,YAAL,CAAkB,QAAlB,EAA4B,KAAKvC,MAAjC;SACKuC,YAAL,CAAkB,QAAlB,EAA4B,4BAA5B;;WAEOpB,WAAP,CAAmBmB,IAAnB;SACKD,UAAL,CAAgBlB,WAAhB,CAA4Ba,MAA5B;;WAEO,KAAKK,UAAZ;GA1F2B;;eA6FhB,uBAAY;QACjBK,UAAU/D,IAAEgE,KAAF,CACd,CACE,GADF,EACO,CAAC,KAAKxD,WAAL,CAAiB8C,GAAlB,EAAuB,KAAK9C,WAAL,CAAiB+C,GAAxC,CADP,EAEE,GAFF,EAEO,CAAC,KAAKxC,cAAL,CAAoBuC,GAArB,EAA0B,KAAKvC,cAAL,CAAoBwC,GAA9C,CAFP,EAE2D,CAAC,KAAK5C,SAAL,CAAe2C,GAAhB,EAAqB,KAAK3C,SAAL,CAAe4C,GAApC,CAF3D,CADc,EAKX;eACQ,KADR;aAEM,KAAKlC,MAFX;YAGK,KAHL;eAIQ,KAAKI,QAJb;cAKO,CALP;iBAMU;KAXC,EAadgC,KAbc,CAaRhB,GAbQ,CAAhB;;YAeQQ,KAAR,CAAcW,YAAd,CAA2B,IAA3B,wBAAqD,KAAKzB,UAA1D;YACQc,KAAR,CAAcW,YAAd,CAA2B,YAA3B,kCAAuE,KAAKzB,UAA5E;;WAEO4B,OAAP;GAhH2B;;gBAoHf,sBAAUE,MAAV,EAAkBC,KAAlB,EAAyBC,KAAzB,EAAgC;QACtCC,UAAUD,QAAQE,KAAKC,EAAb,GAAkB,KAAlC;;WAEO;SACFD,KAAKE,GAAL,CAASH,OAAT,KAAqBF,MAAMM,CAAN,GAAUP,OAAOO,CAAtC,IAA2CH,KAAKI,GAAL,CAASL,OAAT,KAAqBF,MAAMQ,CAAN,GAAUT,OAAOS,CAAtC,CAA3C,GAAsFT,OAAOO,CAD3F;SAEFH,KAAKI,GAAL,CAASL,OAAT,KAAqBF,MAAMM,CAAN,GAAUP,OAAOO,CAAtC,IAA2CH,KAAKE,GAAL,CAASH,OAAT,KAAqBF,MAAMQ,CAAN,GAAUT,OAAOS,CAAtC,CAA3C,GAAsFT,OAAOS;KAFlG;GAvH2B;;oBA6HX,0BAAUC,KAAV,EAAiBC,GAAjB,EAAsB9D,MAAtB,EAA8B;QACxC+D,WAAWC,KAAKC,iBAAL,CAAuB,CACtCD,KAAKZ,KAAL,CAAY,CAACS,MAAMrB,GAAP,EAAYqB,MAAMpB,GAAlB,CAAZ,CADsC,EAEtCuB,KAAKZ,KAAL,CAAY,CAACU,IAAItB,GAAL,EAAUsB,IAAIrB,GAAd,CAAZ,CAFsC,CAAvB,CAAjB;;QAKMyB,YAASF,KAAKE,MAAL,CAAYH,QAAZ,CAAf;;;QAGMI,UAAUxC,IAAIyC,sBAAJ,CAA2BP,KAA3B,CAAhB;QACMQ,WAAW1C,IAAIyC,sBAAJ,CAA2BlF,IAAES,MAAF,CAASuE,UAAOI,QAAP,CAAgBC,WAAhB,CAA4B,CAA5B,CAAT,EAAyCL,UAAOI,QAAP,CAAgBC,WAAhB,CAA4B,CAA5B,CAAzC,CAA3B,CAAjB;QACMC,YAAY,KAAKC,YAAL,CAAkBJ,QAAlB,EAA4BF,OAA5B,EAAqC,EAArC,CAAlB;;QAGMO,WAAWnB,KAAKoB,IAAL,CAAUpB,KAAKqB,GAAL,CAAST,QAAQT,CAAR,GAAYW,SAASX,CAA9B,EAAiC,CAAjC,IAAsCH,KAAKqB,GAAL,CAAST,QAAQP,CAAR,GAAYS,SAAST,CAA9B,EAAiC,CAAjC,CAAhD,CAAjB;QACMP,QAAQE,KAAKsB,KAAL,CAAWL,UAAUZ,CAAV,GAAcS,SAAST,CAAlC,EAAqCY,UAAUd,CAAV,GAAcW,SAASX,CAA5D,CAAd;;QAGMoB,SAAU9E,SAAS0E,QAAV,GAAsBA,QAArC;;QAEMf,MAAMJ,KAAKI,GAAL,CAASN,KAAT,IAAkByB,MAA9B;QACMrB,MAAMF,KAAKE,GAAL,CAASJ,KAAT,IAAkByB,MAA9B;;QAEMC,eAAe7F,IAAEkE,KAAF,CAAQoB,UAAUd,CAAV,GAAcD,GAAtB,EAA2Be,UAAUZ,CAAV,GAAcD,GAAzC,CAArB;;WAEOhC,IAAIqD,sBAAJ,CAA2BD,YAA3B,CAAP;GAtJ2B;;gBAyJf,wBAAW;WAChB7F,IAAE+F,OAAF,CAAU;iBACJ,KAAKxE,WADD;uCAEgB,KAAKY,UAApC,4BAAqE,KAAKO,IAAL,CAAUsD,OAAV,KAAsB,KAAK7E,UAAhG,YAAiH,KAAKF,UAAtH,YAFe;kBAGH,CAAC,KAAKT,WAAL,CAAiB8C,GAAlB,EAAuB,KAAK9C,WAAL,CAAiB+C,GAAxC,CAHG;gBAIL;KAJL,CAAP;GA1J2B;;UAkKrB,gBAAUd,GAAV,EAAe;SAChBwD,eAAL;;QAEMC,YAAY,KAAKlE,IAAL,CAAUmE,cAAV,4BAAkD,KAAKhE,UAAvD,CAAlB;cACUyB,YAAV,CAAuB,aAAvB,OAAyC,MAAM,KAAKlB,IAAL,CAAUsD,OAAV,EAA/C;cACUpC,YAAV,CAAuB,cAAvB,OAA0C,MAAM,KAAKlB,IAAL,CAAUsD,OAAV,EAAhD;;QAEMI,QAAQC,SAASF,cAAT,kBAAuC,KAAKhE,UAA5C,CAAd;UACMyB,YAAN,CAAmB,OAAnB,kBAA0C,KAAKlB,IAAL,CAAUsD,OAAV,KAAsB,GAAtB,GAA4B,KAAK7E,UAA3E;;WAEO,IAAP;GA5K2B;;mBA+KZ,2BAAW;QACpBmF,mBAAmB,KAAK5D,IAAL,CAAUsD,OAAV,EAAzB;;QAEG,CAAC,KAAKzF,mBAAT,EAA8B;WACvByC,YAAL,CAAkBY,YAAlB,CAA+B,SAA/B,EAA0C,KAAKnC,QAA/C;WACK2B,cAAL,CAAoBmD,UAApB,CAA+B,KAAK9E,QAApC;;;QAGC6E,mBAAmB,KAAK3E,QAAxB,IAAoC2E,mBAAmB,KAAKzE,QAA/D,EAAyE;WAClEmB,YAAL,CAAkBY,YAAlB,CAA+B,SAA/B,EAA0C,CAA1C;WACKR,cAAL,CAAoBmD,UAApB,CAA+B,CAA/B;;WAEKhG,mBAAL,GAA2B,KAA3B;;;CA3LU,CAAhB;;;;"}